# PHPStan Configuration for Translation Dashboard
# Run: vendor/bin/phpstan analyse -c phpstan.neon

parameters:
    level: 5

    paths:
        - src

    excludePaths:
        - src_/td_tests/*
        - src/backend/results/sparql_bots/*

    # Treat phpdoc types as assertions for runtime safety
    treatPhpDocTypesAsCertain: true

    # Report unmatched ignored errors
    reportUnmatchedIgnoredErrors: true

    # Universal object crates (classes with dynamic properties)
    universalObjectCratesClasses:
        - stdClass

    # Ignore specific errors during transition
    ignoreErrors:
        # Allow mixed types in legacy code temporarily
        - message: '#^Parameter \w+ has no value type specified in iterable type array\.$#'
          path: src/backend/api_or_sql/*.php

        # Allow dynamic property access during migration
        - message: '#^Access to undefined constant .+\.$#'
          path: src/backend/tables/*.php

        # Ignore missing typehints in test files
        - message: '#^Method .+ has no return type specified\.$#'
          path: src_/td_tests/*.php

    # Bootstrap file for autoloading
    bootstrapFiles:
        - tests/bootstrap.php

    # Scan files for class definitions
    scanFiles:
        - src/include_all.php
